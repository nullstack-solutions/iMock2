<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iMock - Wiremock UI Client</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- CSS files in logical loading order -->
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/modals.css">
    <link rel="stylesheet" href="styles/main.css">
</head>
<body data-theme="light">
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="icon-logo" viewBox="0 0 24 24">
            <rect x="2" y="2" width="20" height="20" rx="6" fill="currentColor"></rect>
            <circle cx="12" cy="12" r="5" fill="none" stroke="#ffffff" stroke-width="2"></circle>
            <path d="M15.5 4c-1.2.4-2.3 1.4-2.9 2.6" fill="none" stroke="#ffffff" stroke-linecap="round" stroke-width="1.5"></path>
        </symbol>
        <symbol id="icon-moon" viewBox="0 0 24 24">
            <path d="M21 14a8 8 0 0 1-10.5-10.5A8 8 0 1 0 21 14z" fill="currentColor"></path>
        </symbol>
        <symbol id="icon-sun" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="4" fill="currentColor"></circle>
            <g stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <line x1="12" y1="2" x2="12" y2="5"></line>
                <line x1="12" y1="19" x2="12" y2="22"></line>
                <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"></line>
                <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"></line>
                <line x1="2" y1="12" x2="5" y2="12"></line>
                <line x1="19" y1="12" x2="22" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"></line>
                <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"></line>
            </g>
        </symbol>
        <symbol id="icon-mappings" viewBox="0 0 24 24">
            <rect x="4" y="5" width="16" height="3" rx="1" fill="currentColor"></rect>
            <rect x="4" y="10.5" width="16" height="3" rx="1" fill="currentColor"></rect>
            <rect x="4" y="16" width="16" height="3" rx="1" fill="currentColor"></rect>
        </symbol>
        <symbol id="icon-requests" viewBox="0 0 24 24">
            <rect x="5" y="5" width="14" height="14" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"></rect>
            <circle cx="9" cy="10" r="1.5" fill="currentColor"></circle>
            <circle cx="9" cy="14" r="1.5" fill="currentColor"></circle>
            <line x1="12.5" y1="10" x2="16" y2="10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
            <line x1="12.5" y1="14" x2="16" y2="14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
        </symbol>
        <symbol id="icon-scenarios" viewBox="0 0 24 24">
            <circle cx="6" cy="6" r="2.5" fill="currentColor"></circle>
            <circle cx="18" cy="6" r="2.5" fill="currentColor"></circle>
            <circle cx="12" cy="18" r="2.5" fill="currentColor"></circle>
            <path d="M7.5 7.5l3.5 8" fill="none" stroke="currentColor" stroke-width="1.6"></path>
            <path d="M16.5 7.5l-3.5 8" fill="none" stroke="currentColor" stroke-width="1.6"></path>
        </symbol>
        <symbol id="icon-data" viewBox="0 0 24 24">
            <path d="M4 6c0-2 4-3 8-3s8 1 8 3-4 3-8 3-8-1-8-3z" fill="none" stroke="currentColor" stroke-width="1.6"></path>
            <path d="M4 11c0 2 4 3 8 3s8-1 8-3" fill="none" stroke="currentColor" stroke-width="1.6"></path>
            <path d="M4 16c0 2 4 3 8 3s8-1 8-3" fill="none" stroke="currentColor" stroke-width="1.6"></path>
        </symbol>
        <symbol id="icon-record" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="6" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
            <circle cx="12" cy="12" r="3" fill="currentColor"></circle>
        </symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
            <path d="M4 12a8 8 0 0 1 .4-2.5l2.2.9a5.5 5.5 0 0 0 0 3.2l-2.2.9A8 8 0 0 1 4 12zm16 0a8 8 0 0 0-.4-2.5l-2.2.9a5.5 5.5 0 0 1 0 3.2l2.2.9A8 8 0 0 0 20 12zm-8-8a8 8 0 0 1 2.5.4l-.9 2.2a5.5 5.5 0 0 0-3.2 0l-.9-2.2A8 8 0 0 1 12 4zm0 16a8 8 0 0 0 2.5-.4l-.9-2.2a5.5 5.5 0 0 1-3.2 0l-.9 2.2A8 8 0 0 0 12 20z" fill="currentColor"></path>
        </symbol>
        <symbol id="icon-refresh" viewBox="0 0 24 24">
            <path d="M4 12a8 8 0 0 1 13.7-5.7L20 9" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
            <path d="M20 12a8 8 0 0 1-13.7 5.7L4 15" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
        </symbol>
        <symbol id="icon-bolt" viewBox="0 0 24 24">
            <path d="M10 3h7l-5 8h5l-8 10 2-7H6z" fill="currentColor"></path>
        </symbol>
        <symbol id="icon-pencil" viewBox="0 0 24 24">
            <path d="M5 19l.7-4.2 8.6-8.6a2 2 0 0 1 2.8 0l1.7 1.7a2 2 0 0 1 0 2.8l-8.6 8.6z" fill="none" stroke="currentColor" stroke-width="1.6"></path>
            <path d="M14 5l3 3" stroke="currentColor" stroke-width="1.6"></path>
        </symbol>
        <symbol id="icon-edit" viewBox="0 0 24 24">
            <rect x="4" y="4" width="16" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"></rect>
            <path d="M9 15l6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
        <symbol id="icon-trash" viewBox="0 0 24 24">
            <path d="M5 7h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M9 7V5h6v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <rect x="6" y="7" width="12" height="13" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"></rect>
        </symbol>
        <symbol id="icon-broom" viewBox="0 0 24 24">
            <path d="M4 18l4-4 6 6" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M15 3l6 6" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M9 14l7-7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
        <symbol id="icon-upload" viewBox="0 0 24 24">
            <path d="M12 17V7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M8 11l4-4 4 4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
            <path d="M5 19h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
        <symbol id="icon-download" viewBox="0 0 24 24">
            <path d="M12 7v10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M8 13l4 4 4-4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
            <path d="M5 5h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
        <symbol id="icon-folder" viewBox="0 0 24 24">
            <path d="M4 6h6l2 3h8a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"></path>
        </symbol>
        <symbol id="icon-play" viewBox="0 0 24 24">
            <path d="M8 5l10 7-10 7z" fill="currentColor"></path>
        </symbol>
        <symbol id="icon-stop" viewBox="0 0 24 24">
            <rect x="7" y="7" width="10" height="10" rx="2" fill="currentColor"></rect>
        </symbol>
        <symbol id="icon-format" viewBox="0 0 24 24">
            <circle cx="7" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
            <path d="M12 8l6-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M11 13l7 7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M5 16l4-1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
        <symbol id="icon-compress" viewBox="0 0 24 24">
            <rect x="4" y="7" width="16" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"></rect>
            <path d="M9 12h6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
            <path d="M12 9v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
        </symbol>
    </svg>
    <div class="header">
        <div class="logo">
            <svg class="icon icon-lg" aria-hidden="true"><use href="#icon-logo"></use></svg>
            <span class="logo-text">iMock</span>
            <span class="version">v2.2</span>
        </div>
        <div class="status">
            <div class="status-indicator">
                <div class="status-dot" id="status-dot"></div>
                <span id="status-text">Disconnected</span>
                <span id="health-indicator" style="display: none; margin-left: 10px; font-size: 0.9em;"></span>
            </div>
            <button class="theme-toggle" onclick="if(typeof toggleTheme === 'function') toggleTheme()" aria-label="Toggle theme">
                <svg id="theme-icon" class="icon icon-md" aria-hidden="true"><use href="#icon-moon"></use></svg>
            </button>
        </div>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <div class="nav-item active" onclick="showPage('mappings', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-mappings"></use></svg>
                <span>Mappings</span>
            </div>
            <div class="nav-item" onclick="showPage('requests', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-requests"></use></svg>
                <span>Request Log</span>
            </div>
            <div class="nav-item" onclick="showPage('scenarios', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-scenarios"></use></svg>
                <span>Scenarios</span>
            </div>
            <div class="nav-item" onclick="showPage('import-export', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-data"></use></svg>
                <span>Import/Export</span>
            </div>
            <div class="nav-item" onclick="showPage('recording', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-record"></use></svg>
                <span>Recording</span>
            </div>
            <div class="nav-item" onclick="showPage('settings', this)">
                <svg class="icon nav-icon" aria-hidden="true"><use href="#icon-settings"></use></svg>
                <span>Settings</span>
            </div>
        </div>
        
        <div class="main-content">
            <!-- MAPPINGS PAGE -->
            <div id="mappings-page">
                <div class="page-header">
                    <div class="stats-spacer" id="stats-spacer"></div>
                    <div class="stats" id="stats" style="display: none;">
                        <div class="stat-card">
                            <div class="stat-number" id="mappings-count">0</div>
                            <div class="stat-label">Mappings</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="requests-count">0</div>
                            <div class="stat-label">Requests</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="scenarios-count">0</div>
                            <div class="stat-label">Scenarios</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="uptime">0s</div>
                            <div class="stat-label">Uptime</div>
                        </div>
                    </div>
                    <div class="toolbar-actions">
                        <span id="data-source-indicator" class="badge badge-secondary" title="Current data source">Source: direct</span>
                        <button class="btn btn-secondary" onclick="refreshMappings()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-refresh"></use></svg>
                            <span class="btn-label">Refresh</span>
                        </button>
                        <button class="btn btn-secondary" onclick="forceRefreshCache()" title="Rebuild the service cache mapping and reload">
                            <span class="btn-spinner loading-spinner" aria-hidden="true"></span>
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-bolt"></use></svg>
                            <span class="btn-label">Force Refresh Cache</span>
                        </button>
                        <button class="btn btn-primary" onclick="openAddMappingModal()" id="add-mapping-btn" disabled>+ Add Mapping</button>
                    </div>
                </div>

                <div class="card" id="connection-setup">
                    <div class="card-header">
                        <h3 class="card-title">Connect to WireMock Server</h3>
                    </div>
                    <p style="margin-bottom: var(--space-6); color: var(--text-secondary);">Enter your WireMock server details to get started:</p>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Host</label>
                            <input type="text" class="form-input" id="wiremock-host" value="localhost">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Port</label>
                            <input type="number" class="form-input" id="wiremock-port" value="8080">
                        </div>
                    <div class="form-group form-actions-group">
                        <button class="btn btn-success" onclick="connectToWireMock()">Connect</button>
                            <button class="btn btn-secondary" onclick="loadMockData()">Demo Mode</button>
                            <button class="btn btn-warning" onclick="checkHealth()">Health Check</button>
                        </div>
                    </div>
                </div>
                
                
                <div class="search-filters" id="search-filters" style="display: none;">
                    <div class="filter-grid">
                        <div class="form-group">
                            <label class="form-label">Method</label>
                            <select class="form-select" id="filter-method" onchange="applyFilters()">
                                <option value="">All Methods</option>
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="DELETE">DELETE</option>
                                <option value="PATCH">PATCH</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Search by URL or Name</label>
                            <input type="text" class="form-input" id="filter-url" placeholder="Enter URL or Name" oninput="applyFilters()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <input type="number" class="form-input" id="filter-status" placeholder="e.g., 200" min="100" max="599" oninput="applyFilters()">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" onclick="clearMappingFilters()">Clear Filters</button>
                        </div>
                    </div>
                </div>
                
                <div id="mappings-loading" class="loading hidden">Loading mappings...</div>
                <div id="mappings-list-container">
                    <div id="mappings-empty" class="empty-state hidden">
                        <h3>No mappings found</h3>
                        <p>Connect to WireMock server or use Demo Mode to see mappings.</p>
                    </div>
                    <div class="cards-container" id="mappings-list" style="display: none;">
                        <!-- Mapping items will be dynamically inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- REQUESTS PAGE -->
            <div id="requests-page" class="hidden">
                <div class="page-header">
                    <div class="page-title">Request Log</div>
                    <div class="toolbar-actions">
                        <span id="requests-source-indicator" class="badge badge-secondary" title="Current data source">Requests: direct</span>
                        <button class="btn btn-secondary" onclick="refreshRequests()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-refresh"></use></svg>
                            <span class="btn-label">Refresh</span>
                        </button>
                        <button class="btn btn-danger" onclick="clearRequests()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-trash"></use></svg>
                            <span class="btn-label">Clear Log</span>
                        </button>
                        <button class="btn btn-secondary" onclick="clearRequestFilters()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-broom"></use></svg>
                            <span class="btn-label">Clear Filters</span>
                        </button>
                    </div>
                </div>
                
                <div class="search-filters">
                    <!-- First row: Basic filters -->
                    <div class="filter-grid">
                        <div class="form-group">
                            <label class="form-label">Method</label>
                            <select class="form-select" id="req-filter-method" onchange="applyRequestFilters()">
                                <option value="">All Methods</option>
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="DELETE">DELETE</option>
                                <option value="PATCH">PATCH</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="req-filter-status" onchange="applyRequestFilters()">
                                <option value="">All Statuses</option>
                                <option value="matched">Matched</option>
                                <option value="unmatched">Unmatched</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">URL Pattern</label>
                            <input type="text" class="form-input" id="req-filter-url" placeholder="e.g., /api/*" oninput="applyRequestFilters()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quick Filter</label>
                            <select class="form-select" id="req-filter-quick" onchange="applyQuickFilter()">
                                <option value="">Select time range</option>
                                <option value="5m">Last 5 minutes</option>
                                <option value="15m">Last 15 minutes</option>
                                <option value="30m">Last 30 minutes</option>
                                <option value="1h">Last 1 hour</option>
                                <option value="3h">Last 3 hours</option>
                                <option value="6h">Last 6 hours</option>
                                <option value="12h">Last 12 hours</option>
                                <option value="1d">Last 1 day</option>
                                <option value="3d">Last 3 days</option>
                                <option value="7d">Last 7 days</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Second row: Time Range -->
                    <div class="filter-grid" style="margin-top: var(--space-3);">
                        <div class="form-group">
                            <label class="form-label">Custom Time Range</label>
                            <div class="responsive-inline-group">
                                <input type="datetime-local" class="form-input" id="req-filter-from" onchange="clearQuickFilter(); applyRequestFilters()" placeholder="From">
                                <input type="datetime-local" class="form-input" id="req-filter-to" onchange="clearQuickFilter(); applyRequestFilters()" placeholder="To">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="requests-loading" class="loading hidden">Loading requests...</div>
                <div id="requests-list-container">
                    <div id="requests-empty" class="empty-state hidden">
                        <h3>No requests logged</h3>
                        <p>Make some API calls to see them here.</p>
                    </div>
                    <div class="cards-container" id="requests-list" style="display: none;">
                        <!-- Request items will be dynamically inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- SCENARIOS PAGE -->
            <div id="scenarios-page" class="hidden">
                <div class="page-header">
                    <div class="page-title">Scenario Management</div>
                    <div class="toolbar-actions">
                        <button class="btn btn-secondary" onclick="refreshScenarios()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-refresh"></use></svg>
                            <span class="btn-label">Refresh</span>
                        </button>
                        <button class="btn btn-danger" onclick="resetAllScenarios()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-refresh"></use></svg>
                            <span class="btn-label">Reset All</span>
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Scenario State Control</h3>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Scenario</label>
                            <select class="form-select" id="scenario-select">
                                <option value="">Select Scenario</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Set State</label>
                            <input type="text" class="form-input" id="scenario-state" placeholder="Enter state name" list="scenario-state-options">
                            <datalist id="scenario-state-options"></datalist>
                        </div>
                        <div class="form-group form-actions-group">
                            <button class="btn btn-primary" id="scenario-update-btn" onclick="updateScenarioState()">Update State</button>
                        </div>
                    </div>
                </div>
                
                <div id="scenarios-loading" class="loading hidden">Loading scenarios...</div>
                <div id="scenarios-list-container">
                    <div id="scenarios-empty" class="empty-state hidden">
                        <h3>No scenarios found</h3>
                        <p>Create mappings with scenarios to manage state here.</p>
                    </div>
                    <div class="cards-container" id="scenarios-list" style="display: none;">
                        <!-- Scenario items will be dynamically inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- IMPORT/EXPORT PAGE -->
            <div id="import-export-page" class="hidden">
                <div class="page-header">
                    <div class="page-title">Import/Export</div>
                </div>
                
                <div class="card-grid card-grid-2">
                    <!-- Export Section -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <svg class="icon icon-md" aria-hidden="true"><use href="#icon-download"></use></svg>
                                <span>Export Data</span>
                            </h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Export Format</label>
                            <select class="form-select" id="export-format">
                                <option value="json">JSON</option>
                                <option value="yaml">YAML</option>
                            </select>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                            <button class="btn btn-primary" onclick="exportMappings()">
                                <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-download"></use></svg>
                                <span class="btn-label">Export All Mappings</span>
                            </button>
                            <button class="btn btn-secondary" onclick="exportRequests()">
                                <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-download"></use></svg>
                                <span class="btn-label">Export Request Log</span>
                            </button>
                        </div>
                        <div id="export-result" style="margin-top: var(--space-4);"></div>
                        <p class="form-help" style="margin-top: var(--space-3);">
                            Looking for ready-made mocks? Explore the <a href="https://library.wiremock.org/" target="_blank" rel="noopener">WireMock Templates Library</a> for example mappings you can import or adapt.</p>
                    </div>
                    
                    <!-- Import Section -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <svg class="icon icon-md" aria-hidden="true"><use href="#icon-upload"></use></svg>
                                <span>Import Data</span>
                            </h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Import File</label>
                            <div class="file-input-container">
                                <input type="file" class="file-input" id="import-file" accept=".json,.yaml,.yml" onchange="updateFileDisplay()">
                                <label for="import-file" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                                    <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-folder"></use></svg>
                                    <span class="btn-label">Choose File</span>
                                </label>
                                <div class="file-display" style="margin-top: var(--space-2); padding: var(--space-3); background: var(--bg-secondary); border-radius: var(--radius-md); text-align: center; color: var(--text-secondary);" id="file-display">
                                    <span class="file-placeholder">No file selected</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Import Mode</label>
                            <select class="form-select" id="import-mode">
                                <option value="MERGE">MERGE (default)</option>
                                <option value="OVERWRITE">OVERWRITE</option>
                                <option value="DELETE_ALL">DELETE_ALL</option>
                                <option value="STANDARD">STANDARD</option>
                            </select>
                            <p class="form-help">Select how WireMock should handle existing mappings during import.</p>
                        </div>
                        <div class="form-group" id="import-actions" style="display: none;">
                            <button class="btn btn-primary" id="import-submit-btn" onclick="executeImportFromUi()">
                                <span class="btn-spinner loading-spinner" aria-hidden="true"></span>
                                <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-upload"></use></svg>
                                <span class="btn-label">Import</span>
                            </button>
                        </div>
                        <div id="import-result" style="margin-top: var(--space-4);"></div>
                    </div>
                </div>
            </div>
            
            <!-- RECORDING PAGE -->
            <div id="recording-page" class="hidden">
                <div class="page-header">
                    <div class="page-title">Recording</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <svg class="icon icon-md" aria-hidden="true"><use href="#icon-record"></use></svg>
                            <span>Record API Calls</span>
                        </h3>
                    </div>
                    <p style="margin-bottom: var(--space-4); color: var(--text-secondary);">Configure recording settings to capture real API calls and generate mappings automatically.</p>
                    <p class="form-help" style="margin-bottom: var(--space-4);">Need the classic recorder interface? Open <a id="recorder-link" href="" target="_blank" rel="noopener">configure host to enable link</a>.</p>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Target URL</label>
                            <input type="text" class="form-input" id="record-target-url" placeholder="https://api.example.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Recording Mode</label>
                            <select class="form-select" id="record-mode">
                                <option value="record">Record</option>
                                <option value="snapshot">Snapshot</option>
                            </select>
                        </div>
                    </div>

                    <div class="toolbar-actions" style="margin-top: var(--space-4);">
                        <button class="btn btn-success" onclick="startRecording()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-play"></use></svg>
                            <span class="btn-label">Start Recording</span>
                        </button>
                        <button class="btn btn-danger" onclick="stopRecording()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-stop"></use></svg>
                            <span class="btn-label">Stop Recording</span>
                        </button>
                        <button class="btn btn-secondary" onclick="clearRecordings()">
                            <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-trash"></use></svg>
                            <span class="btn-label">Clear Recordings</span>
                        </button>
                    </div>

                    <div id="recording-status" style="margin-top: var(--space-4);"></div>
                    </div>

                <div id="recordings-list" style="margin-top: var(--space-6);">
                    <!-- Recorded mappings will appear here -->
                </div>
            </div>
            
            <!-- SETTINGS PAGE -->
            <div id="settings-page" class="hidden">
                <div class="page-header">
                    <div class="page-title">Settings</div>
                </div>
                
                <div class="card-grid card-grid-2">
                    <!-- General Settings -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <svg class="icon icon-md" aria-hidden="true"><use href="#icon-settings"></use></svg>
                                <span>General Settings</span>
                            </h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Theme</label>
                            <select class="form-select" id="theme-select" onchange="changeTheme()">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="auto">Auto</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Auto-refresh Interval (seconds)</label>
                            <input type="number" class="form-input" id="refresh-interval" value="" min="0" max="300">
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="auto-refresh-enabled"> Enable Auto-refresh
                            </label>
                        </div>
                    </div>
                    
                    <!-- Connection Settings -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <svg class="icon icon-md" aria-hidden="true"><use href="#icon-data"></use></svg>
                                <span>Connection Settings</span>
                            </h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Host</label>
                            <input type="text" class="form-input" id="default-host" value="">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Port</label>
                            <input type="number" class="form-input" id="default-port" value="">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Request Timeout (ms)</label>
                            <input type="number" class="form-input" id="request-timeout" value="" min="1000" max="600000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Authorization Header</label>
                            <input type="text" class="form-input" id="auth-header" placeholder="Bearer token123 or Basic dXNlcjpwYXNz">
                            <small class="form-help">Optional. Will be added to all WireMock API requests</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="cache-enabled"> Enable Cache </label>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: var(--space-6); text-align: center;">
                    <button class="btn btn-primary" onclick="saveSettings()">
                        <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-download"></use></svg>
                        <span class="btn-label">Save Settings</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetSettings()">
                        <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-refresh"></use></svg>
                        <span class="btn-label">Reset to Defaults</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL FOR ADDING/EDITING MAPPINGS -->
    <div id="add-mapping-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn btn-primary" onclick="saveMappingWrapper()">Save Mapping</button>
                <h3 id="modal-title">Add New Mapping</h3>
                <button class="modal-close" onclick="hideModal('add-mapping-modal')">&times;</button>
            </div>
            <form id="mapping-form">
                <input type="hidden" id="mapping-id">
                
                <div class="form-group">
                    <label class="form-label">Mapping Name</label>
                    <input type="text" class="form-input" id="mapping-name" placeholder="Enter mapping name">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Method</label>
                        <select class="form-select" id="method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">URL Pattern</label>
                        <input type="text" class="form-input" id="url-pattern" placeholder="/api/users" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Status</label>
                    <input type="number" class="form-input" id="response-status" value="200" min="100" max="599">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Body</label>
                    <textarea class="form-textarea" id="response-body" rows="6" placeholder='{ "message": "Hello World" }'></textarea>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL FOR EDITING MAPPINGS -->
    <div id="edit-mapping-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-main">
                    <h3 id="edit-modal-title">Edit Mapping</h3>
                    <span id="editor-dirty-indicator" class="dirty-indicator" style="display: none;">‚óè Unsaved changes</span>
                </div>
                <div class="modal-header-actions">
                    <button type="button" class="btn btn-secondary btn-sm" data-action="format-json">
                        <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-format"></use></svg>
                        <span class="btn-label">Format</span>
                    </button>
                    <button type="button" class="btn btn-secondary btn-sm" data-action="minify-json">
                        <svg class="icon icon-sm" aria-hidden="true"><use href="#icon-compress"></use></svg>
                        <span class="btn-label">Minify</span>
                    </button>
                    <button type="button" class="btn btn-primary" id="update-mapping-btn" onclick="updateMapping()">
                        <span class="btn-label">Update Mapping</span>
                        <span class="btn-spinner loading-spinner" aria-hidden="true"></span>
                    </button>
                    <button class="modal-close" onclick="hideModal('edit-mapping-modal')">&times;</button>
                </div>
            </div>
            
            <!-- Form Editor (Hidden by default) -->
            <div id="form-editor-container" style="display: none;">
            <form id="edit-mapping-form">
                <input type="hidden" id="edit-mapping-id">
                
                <div class="form-group">
                    <label class="form-label">Mapping Name</label>
                    <input type="text" class="form-input" id="edit-mapping-name" placeholder="Enter mapping name">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Method</label>
                        <select class="form-select" id="edit-method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">URL Pattern</label>
                        <input type="text" class="form-input" id="edit-url-pattern" placeholder="/api/users" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Status</label>
                    <input type="number" class="form-input" id="edit-response-status" value="200" min="100" max="599">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Delay (ms)</label>
                    <input type="number" class="form-input" id="edit-response-delay" placeholder="Delay in milliseconds">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Request Headers (JSON)</label>
                    <textarea class="form-textarea" id="edit-request-headers" rows="3" placeholder='{ "Content-Type": "application/json" }'></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Request Body</label>
                    <textarea class="form-textarea" id="edit-request-body" rows="3" placeholder='{ "name": "example" }'></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Headers (JSON)</label>
                    <textarea class="form-textarea" id="edit-response-headers" rows="3" placeholder='{ "Content-Type": "application/json" }'></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Response Body</label>
                    <textarea class="form-textarea" id="edit-response-body" rows="6" placeholder='{ "message": "Hello World" }'></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <input type="number" class="form-input" id="edit-mapping-priority" placeholder="Priority">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Scenario Name</label>
                        <input type="text" class="form-input" id="edit-mapping-scenario" placeholder="Scenario name">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Required Scenario State</label>
                        <input type="text" class="form-input" id="edit-required-scenario-state" placeholder="State required to match">
                    </div>
                    <div class="form-group">
                        <label class="form-label">New Scenario State</label>
                        <input type="text" class="form-input" id="edit-new-scenario-state" placeholder="State after match">
                    </div>
                </div>
            </form>
            </div>
            
            <!-- JSON Editor Container -->
            <div id="json-editor-container" class="json-editor-wrapper">
                <textarea id="json-editor" class="json-editor" rows="1" placeholder="{
  \"name\": \"My Mapping\",
  \"request\": {
    \"method\": \"GET\",
    \"url\": \"/api/example\"
  },
  \"response\": {
    \"status\": 200,
    \"body\": \"{\\\"message\\\":\\\"Hello World\\\"}\",
    \"headers\": {
      \"Content-Type\": \"application/json\"
    }
  }
}"></textarea>
            </div>
        </div>
    </div>

    <!-- MODAL FOR REQUEST DETAILS -->
    <div id="request-details-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Request Details</h3>
                <button class="modal-close" onclick="hideModal('request-details-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="request-details-content">
                    <!-- Request details will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="hideModal('request-details-modal')">Close</button>
            </div>
        </div>
    </div>

    <!-- MODAL FOR MAPPING DETAILS -->
    <div id="mapping-details-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Mapping Details</h3>
                <button class="modal-close" onclick="hideModal('mapping-details-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="mapping-details-content">
                    <!-- Mapping details will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="hideModal('mapping-details-modal')">Close</button>
            </div>
        </div>
    </div>

<!-- JavaScript modules in loading order -->
<script src="js/vendor-js-yaml.min.js"></script>
<script src="js/core.js"></script>
<script src="js/managers.js"></script>
<script src="js/features.js"></script>
<script src="js/editor.js"></script>
<script src="js/main.js"></script>

</body>
</html>
